# Callback State Update

- 좋아요를 글마다 따로 관리할 때 상태를 배열로 둠: `let [like, setLikes] = useState([0, 0, 0]);`.
- 클릭 시 함수형 업데이트(콜백)를 써서 최신 상태(`prev`)로 계산:

```jsx
setLikes(prev => {
  const more = [...prev]; // prev를 얕게 복사
  more[index] += 1;       // 클릭한 글만 +1
  return more;            // 새 배열로 교체
});
```

## prev(콜백 인자)
- React가 setState 호출 시 넘겨주는 “최신 상태” 값. 이름은 자유(`currentLikes` 등).
- 바깥에 캡처된 `like` 대신 콜백 인자를 써야 연속 클릭/배치 업데이트에서도 누락 없이 누적.
- 매개변수가 하나면 `prev => { ... }`처럼 괄호를 생략해도 되고 `(prev) => { ... }`도 동일.

## 스프레드 복사
- `...`는 배열/객체를 “펼쳐서” 새 배열/객체를 만드는 문법.
- `const more = [...prev];`로 얕은 복사 후 수정 → 원본(state)을 직접 변형하지 않음.
- 원시값 배열이면 완전히 분리되고, 객체를 담은 배열이면 객체 참조는 공유됨(내부 수정 시 주의).

## 왜 사본을 쓰나
- state를 직접 mutate 하면 React가 변경을 못 감지할 수 있음.
- 새 참조(복사본)를 반환해야 React가 “바뀌었네” 하고 리렌더.

## 한 줄 요약
- 배열 state를 수정할 땐: 콜백 setState + 스프레드로 복사 + 수정 후 새 배열 반환.
